<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <title>Student List</title>
    <meta charSet="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <style media="only screen">
        html,
        body {
            height: 100%;
            width: 100%;
            margin: 0;
            box-sizing: border-box;
            -webkit-overflow-scrolling: touch;
        }

        html {
            position: absolute;
            top: 0;
            left: 0;
            padding: 0;
            overflow: auto;
        }

        body {
            padding: 1rem;
            overflow: auto;
        }

        body {
            background: #fffefe;
        }

        body h1 {
            align-items: center;
        }

        ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #000000;
            width: 100%;
        }

        li a {
            float: right;
        }

        li span {
            float: left;
        }

        li span {
            align-items: center;
            text-decoration: none;
            color: #ffffff;
            text-transform: uppercase;
            font-size: 20px;
            font-weight: 600;
            padding: 14px 16px;
        }

        li a {
            align-items: center;
            text-decoration: none;
            color: #ffffff;
            text-transform: uppercase;
            font-size: 20px;
            font-weight: 600;
            padding: 14px 16px;
        }

        li a:hover {
            color: #F81818;
            transition: all .5s;
            cursor: pointer;
        }

        li span:hover {
            color: #4df3ff;
            transition: all .5s;
            cursor: pointer;
        }

        .sidenav {
            height: 100%;
            /* 100% Full-height */
            width: 0;
            /* 0 width - change this with JavaScript */
            position: fixed;
            /* Stay in place */
            z-index: 1;
            /* Stay on top */
            top: 0;
            /* Stay at the top */
            left: 0;
            background-color: #111;
            /* Black*/
            overflow-x: hidden;
            /* Disable horizontal scroll */
            padding-top: 60px;
            /* Place content 60px from the top */
            transition: 0.5s;
            /* 0.5 second transition effect to slide in the sidenav */
        }

        /* The navigation menu links */
        .sidenav a {
            padding: 8px 8px 8px 32px;
            text-decoration: none;
            font-size: 25px;
            color: #818181;
            display: block;
            transition: 0.3s;
        }

        /* When you mouse over the navigation links, change their color */
        .sidenav a:hover {
            color: #f1f1f1;
        }

        /* Position and style the close button (top right corner) */
        .sidenav .closebtn {
            position: absolute;
            top: 0;
            right: 25px;
            font-size: 36px;
            margin-left: 50px;
        }

        /* Style page content - use this if you want to push the page content to the right when you open the side navigation */
        #main {
            transition: margin-left .5s;
            padding: 20px;
        }

        /* On smaller screens, where height is less than 450px, change the style of the sidenav (less padding and a smaller font size) */
        @media screen and (max-height: 450px) {
            .sidenav {
                padding-top: 15px;
            }

            .sidenav a {
                font-size: 18px;
            }
        }

        .but {
            background: green;
            color: white;
            border: none;
            width: 140px;
            height: 40px;
            border-radius: 3px 3px 3px 3px;
            margin-left: 30px;
            margin-top: 100px;
            box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.6);

        }

        .but:hover {
            background: rgba(16, 150, 47);
        }
    </style>
</head>

<body>
    <div class="navbar">
        <nav>
            <ul>
                <li><a th:href="@{/logout}">Logout</a></li>
                <li class="menu"><span onclick="openNav()">Menu</span></li>
            </ul>
        </nav>
    </div>
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <a th:href="@{/adminHome}">Home</a>
        <a th:href="@{/listofusers}">Student List</a>
        <a th:href="@{/attendanceAdmin}">Attendance</a>
        <a th:href="@{/resultAdmin}">Result</a>
        <a th:href="@{/departmentlist}">Department</a>
        <a th:href="@{/semesterlist}">Semester List</a>
        <a th:href="@{/subjectDetails}">Subject Details</a>
        <a th:href="@{/examlist}">Exam Details</a>
    </div>


    <div style="height: 100%; box-sizing: border-box">
        <div id="myGrid" style="height: 100%" class="ag-theme-alpine">
        </div>
    </div>
    <input type="text" id="users" th:value="${listOfStudents}" style="display:none;">



    <form th:action="@{/Approve}" method="post" th:onclick="return checkForm()">

        <input type="text" placeholder="...." id="userCode" readonly required style="display: none">
        <div class="button">
            <button type="button" class="approve-button" id="approve-btn">Approve</button>
            <button type="button" class="reject-button" id="reject-btn">Reject</button>
        </div>
        <!-- confirmation popup start -->
        <div class="modal">
            <div class="modalContent">
                <span class="close">×</span>
                <p>Are you sure you want to Approve</p>
                <button class="confirm" type="submit">Approve</button>
                <button class="cancel" type="button" th:onclick="hideModal()">Cancel</button>
            </div>
        </div>
        <!-- confirmation popup end -->
        <!-- reject popup start -->
        <div class="modalReject">
            <div class="modalContent">
                <span class="close" id="reject-close">×</span>
                <p>Are you sure you want to Reject</p>
                <button class="confirm" type="submit" id="reject-button" th:formaction="@{/Reject}">Reject</button>
                <button class="cancel" id="reject-cancel" type="button" th:onclick="hideModal()">Cancel</button>
            </div>
        </div>
        <!-- reject popup end -->
    </form>

    <script>
        function checkForm() {
            let inputField = document.getElementById('donationCode').value;
            if (inputField == "") {
                alert('Please select the donation')
                return false;
            }

            if (approveBtn == 'clicked') {

                modal.style.display = "block";

            }
            if (rejectBtn == 'clicked') {

                modalReject.style.display = "block";

            }
            return true;
        }

    </script>

    <script>
        function openNav() {
            document.getElementById("mySidenav").style.width = "250px";
        }

        /* Set the width of the side navigation to 0 */
        function closeNav() {
            document.getElementById("mySidenav").style.width = "0";
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@30.0.2/dist/ag-grid-community.min.js">
    </script>
    <script>
        const gridOptions = {
            // define grid columns
            columnDefs: [
                // using number column type
                {
                    id: "select",
                    name: "Select",
                    field: "select",
                    width: 100,
                    formatter: checkboxFormatter

                },
                {
                    id: "userId",
                    name: "userId",
                    field: "userId",
                    type: 'numberColumn',
                    width: 100,
                    sortable: true
                },

                // using default ColDef
                {
                    id: "firstName",
                    name: "firstName",
                    field: "firstName",
                    sortable: true
                },
                {
                    id: "lastName",
                    name: "lastName",
                    field: "lastName",
                    sortable: true
                },

                {
                    id: "gender",
                    name: "gender",
                    field: "gender",
                    width: 100,
                    sortable: true
                },

                {
                    id: "parentName",
                    name: "parentName",
                    field: "parentName",
                    sortable: true
                },

                // using date and non-editable column types
                {
                    id: "email",
                    name: "email",
                    field: "email",
                    sortable: true
                },


                // using number column type
                {
                    id: "phone",
                    name: "phone",
                    field: "phone",
                    type: 'numberColumn',
                    sortable: true
                },
                // using default ColDef
                {
                    id: "department",
                    name: "department",
                    field: "department",
                    sortable: true
                },


                {
                    id: "status",
                    name: "status",
                    field: "status",
                    width: 100,
                    sortable: true
                },

                {
                    id: "approve",
                    name: "approve",
                    field: "approve",
                    formatter: buttonFormatter,
                    width: 200
                },
            ],



            // default ColDef, gets applied to every column
            defaultColDef: {
                // set the default column width
                width: 150,
                // make every column editable
                editable: true,
                // make every column use 'text' filter by default
                filter: 'agTextColumnFilter',
                // enable floating filters by default
                floatingFilter: true,
                // make columns resizable
                resizable: true,
                // disable cell data types
                cellDataType: false,
            },

            // default ColGroupDef, get applied to every column group
            defaultColGroupDef: {
                marryChildren: true,
            },
        

        // define specific column types
        columnTypes: {
            numberColumn: { width: 130, filter: 'agNumberColumnFilter' },
            nonEditableColumn: { editable: false },
            dateColumn: {
                // specify we want to use the date filter
                filter: 'agDateColumnFilter',

                    // add extra parameters for the date filter
                    filterParams: {
                    // provide comparator function
                    comparator: (filterLocalDateAtMidnight, cellValue) => {
                        // In the example application, dates are stored as dd/mm/yyyy
                        // We create a Date object for comparison against the filter date
                        const dateParts = cellValue.split('/');
                        const day = Number(dateParts[0]);
                        const month = Number(dateParts[1]) - 1;
                        const year = Number(dateParts[2]);
                        const cellDate = new Date(year, month, day);

                        // Now that both parameters are Date objects, we can compare
                        if (cellDate < filterLocalDateAtMidnight) {
                            return -1;
                        } else if (cellDate > filterLocalDateAtMidnight) {
                            return 1;
                        } else {
                            return 0;
                        }
                    },
                    },
            },
        },
        rowData: null,
        };

        function buttonFormatter(row, cell, value, columnDef, dataContext) {
            let a = dataContext.userId;
            console.log(a);
            return '<form action="/aprove" metod="get"><button type="submit"  class="but" name="user_id" value="' + a + '">Aprove</button></form>';

        }
        /* check box funtion start */
        function checkboxFormatter(row, cell, value, columnDef, dataContext) {
            let a = dataContext.userCode;
            return '<input type="checkbox" value="' + a + '" name="checkName" id="checkBox"' + (value ? 'checked="checked"' : '') + '/>';
        }

        //var check= document.getElementById("checkBox");
        let check = document.querySelectorAll('input[type="checkbox"]:checked');
        console.log(check);

        /* check box funtion end */

        // setup the grid after the page has finished loading
        document.addEventListener('DOMContentLoaded', () => {
            let gridDiv = document.querySelector('#myGrid');
            new agGrid.Grid(gridDiv, gridOptions);

            let data = document.getElementById("users").value;
            console.log(data);

            var data1 = JSON.parse(data);
            console.log(data1);

            gridOptions.api.setRowData(data1);
        });


    </script>
</body>

</html>